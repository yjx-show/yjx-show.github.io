var N=Object.defineProperty,$=Object.defineProperties;var T=Object.getOwnPropertyDescriptors;var w=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable;var _=(t,e,a)=>e in t?N(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,b=(t,e)=>{for(var a in e||(e={}))j.call(e,a)&&_(t,a,e[a]);if(w)for(var a of w(e))L.call(e,a)&&_(t,a,e[a]);return t},x=(t,e)=>$(t,T(e));var h=(t,e,a)=>new Promise((s,o)=>{var i=l=>{try{c(a.next(l))}catch(u){o(u)}},p=l=>{try{c(a.throw(l))}catch(u){o(u)}},c=l=>l.done?s(l.value):Promise.resolve(l.value).then(i,p);c((a=a.apply(t,e)).next())});import{L as P,M as D,u as M,r as O,t as A,$ as F,v as q,O as G,o as H,x as g,b as R,c as S,g as m,w as V,d,F as I,i as v,m as k,f as X,k as z}from"./index.ea97895c.js";import{N as J}from"./index.8e3d99df.js";function K(t){return P({url:D.api.public.getCaptcha,method:"get",params:t})}var y,Q=new Uint8Array(16);function W(){if(!y&&(y=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!y))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return y(Q)}var Y=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Z(t){return typeof t=="string"&&Y.test(t)}var n=[];for(var C=0;C<256;++C)n.push((C+256).toString(16).substr(1));function ee(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=(n[t[e+0]]+n[t[e+1]]+n[t[e+2]]+n[t[e+3]]+"-"+n[t[e+4]]+n[t[e+5]]+"-"+n[t[e+6]]+n[t[e+7]]+"-"+n[t[e+8]]+n[t[e+9]]+"-"+n[t[e+10]]+n[t[e+11]]+n[t[e+12]]+n[t[e+13]]+n[t[e+14]]+n[t[e+15]]).toLowerCase();if(!Z(a))throw TypeError("Stringified UUID is invalid");return a}function te(t,e,a){t=t||{};var s=t.random||(t.rng||W)();if(s[6]=s[6]&15|64,s[8]=s[8]&63|128,e){a=a||0;for(var o=0;o<16;++o)e[a+o]=s[o];return e}return ee(s)}const ae=()=>{const t=M(),e=O({username:"",password:"",confirmPassword:"",captcha:"",captchaSvg:null}),a=()=>h(void 0,null,function*(){const{data:o}=yield K({id:te()});e.captchaSvg=o}),s=o=>h(void 0,null,function*(){if(F.hasEmoji(o.username)){q.fail("\u8BF7\u52FF\u8F93\u5165\u8868\u60C5\u5305");return}if(F.hasEmoji(o.password)){q.fail("\u8BF7\u52FF\u8F93\u5165\u8868\u60C5\u5305");return}const{data:i}=yield G(b({},o));i&&J({type:"success",message:"\u6CE8\u518C\u6210\u529F\uFF0C\u8BF7\u91CD\u65B0\u767B\u5F55",duration:2e3,onOpened:()=>{t.back()}})});return x(b({},A(e)),{requestCaptcha:a,onSubmit:s})},ne={style:{background:"#eee",height:"34px"}},oe=["src"],ue={style:{margin:"16px"}},se=z(" \u63D0\u4EA4 "),ie={__name:"signup",setup(t){H(()=>{p()});const{username:e,password:a,confirmPassword:s,captchaSvg:o,captcha:i,requestCaptcha:p,onSubmit:c}=ae();return(l,u)=>{const B=g("van-nav-bar"),f=g("van-field"),E=g("van-button"),U=g("van-form");return R(),S(I,null,[m(B,{title:"\u7528\u6237\u6CE8\u518C","left-text":"\u8FD4\u56DE","left-arrow":"",onClickLeft:u[0]||(u[0]=r=>l.$router.back())}),m(U,{class:"form",onSubmit:d(c),style:{padding:"12px"}},{default:V(()=>[m(f,{modelValue:d(e),"onUpdate:modelValue":u[1]||(u[1]=r=>v(e)?e.value=r:null),type:"text",required:"",name:"username",clearable:"",label:"\u7528\u6237\u540D",placeholder:"\u7528\u6237\u540D",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u7528\u6237\u540D!"}]},null,8,["modelValue"]),m(f,{modelValue:d(a),"onUpdate:modelValue":u[2]||(u[2]=r=>v(a)?a.value=r:null),type:"password",required:"",name:"password",clearable:"",label:"\u8BBE\u7F6E\u5BC6\u7801",placeholder:"\u8BBE\u7F6E\u5BC6\u7801",rules:[{required:!0,message:"\u8BF7\u8BBE\u7F6E\u5BC6\u7801!"}]},null,8,["modelValue"]),m(f,{modelValue:d(s),"onUpdate:modelValue":u[3]||(u[3]=r=>v(s)?s.value=r:null),type:"text",required:"",clearable:"",name:"confirmPassword",label:"\u786E\u8BA4\u5BC6\u7801",placeholder:"\u786E\u8BA4\u5BC6\u7801",rules:[{required:!0,message:"\u8BF7\u518D\u6B21\u8F93\u5165\u5BC6\u7801\u786E\u8BA4!"}]},null,8,["modelValue"]),m(f,{modelValue:d(i),"onUpdate:modelValue":u[5]||(u[5]=r=>v(i)?i.value=r:null),type:"text",required:"",clearable:"",name:"captcha",maxlength:"4",label:"\u56FE\u5F62\u9A8C\u8BC1\u7801",placeholder:"\u8BF7\u8F93\u5165\u56FE\u5F62\u9A8C\u8BC1\u7801",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u56FE\u5F62\u9A8C\u8BC1\u7801\uFF01"}]},{button:V(()=>[k("div",ne,[d(o)?(R(),S("img",{key:0,onClick:u[4]||(u[4]=(...r)=>d(p)&&d(p)(...r)),src:d(o),alt:"Base64 encoded image",width:"70",height:"35"},null,8,oe)):X("",!0)])]),_:1},8,["modelValue"]),k("div",ue,[m(E,{round:"",block:"",type:"primary","native-type":"submit"},{default:V(()=>[se]),_:1})])]),_:1},8,["onSubmit"])],64)}}};export{ie as default};
